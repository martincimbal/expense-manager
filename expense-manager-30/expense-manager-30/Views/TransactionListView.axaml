<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:expense_manager_30.ViewModels"
             xmlns:system="clr-namespace:System;assembly=System.Runtime"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="expense_manager_30.Views.TransactionListView"
             x:DataType="vm:TransactionListViewModel">


<StackPanel Margin="20"
            Spacing="10">
        <TextBlock Text="All Transactions"
                   FontSize="20"
                   FontWeight="Bold"/>
        
        <StackPanel Orientation="Horizontal"
                    Spacing="10">
            
            <TextBlock Text="From"
                       VerticalAlignment="Center"/>
            
            <DatePicker SelectedDate="{Binding StartDateFilter}"
                        Width="300"/>
            
            <TextBlock Text="To"
                       VerticalAlignment="Center"/>
            
            <DatePicker SelectedDate="{Binding EndDateFilter}"
                        Width="300"/>
        </StackPanel>

        <StackPanel Orientation="Horizontal" Spacing="10">
            <ComboBox ItemsSource="{Binding Categories}"
                      SelectedItem="{Binding SelectedFilterCategory}"
                      MaxWidth="300"
                      
                      />

            <CheckBox Content="Income only"
                      IsChecked="{Binding IsIncomeFilter}"
                      VerticalAlignment="Center"/>

            <TextBox Width="150"
                     Text="{Binding NoteFilter}"
                     Watermark="Note contains..."/>

            <Button Content="Filter"
                    Command="{Binding ApplyFilterCommand}"/>
            <Button Content="Clear"
                    Command="{Binding ClearFilterCommand}"/>
        </StackPanel>


        <TextBlock Text="{Binding StatusMessage}"
                   Foreground="Green"/>
        
        <DataGrid ItemsSource="{Binding Transactions}"
                  AutoGenerateColumns="False"
                  x:Name="MyDataGrid"
                  ScrollViewer.VerticalScrollBarVisibility="Auto">
            
            <DataGrid.Columns>
                <DataGridTextColumn Header="Date"
                                    Binding="{Binding FormattedDate}"
                                    Width="150"/>
                
                <DataGridTextColumn Header="Amount"
                                    Binding="{Binding Amount}"
                                    Width="*"/>
                
                <DataGridCheckBoxColumn Header="Income"
                                        Binding="{Binding IsIncome}"
                                        Width="90"/>
                
                <DataGridTextColumn Header="Category"
                                    Binding="{Binding CategoryName}"
                                    Width="*"/>
                
                <DataGridTextColumn Header="Note"
                                    Binding="{Binding Note}"
                                    Width="*"/>
                
                <DataGridTemplateColumn Header="Action">
                    <DataGridTemplateColumn.CellTemplate> 
                        <DataTemplate> 
                            <Button
                                Content="Edit"
                                Command="{Binding #MyDataGrid.((vm:TransactionListViewModel)DataContext).EditTransactionCommand}"
                                CommandParameter="{Binding}"
                                Width="70"/> 
                        </DataTemplate> 
                    </DataGridTemplateColumn.CellTemplate> 
                </DataGridTemplateColumn>

            </DataGrid.Columns>
        </DataGrid>
    </StackPanel>
</UserControl>


